[*] VCF input file /home/mcn26/scratch_pi_skr2/mcn26/sumner_pulldown/chr1_chr22/GRCh38-dELS-chr1_chr22chunk_toy.tsv
[*] Fasta file /home/mcn26/scratch_pi_skr2/mcn26/GRCh38_no_alt_analysis_set_GCA_000001405.15.fasta
[*] Output /home/mcn26/scratch_pi_skr2/mcn26/output/5000_chr1_chr22/chunk_toy.vcf
[+] Running!
archive unpacked in ./
archive unpacked in ./
archive unpacked in ./
archive unpacked in ./
archive unpacked in ./
archive unpacked in ./
archive unpacked in ./
archive unpacked in ./
archive unpacked in ./
archive unpacked in ./
pre-reading fasta into memory
['/home/mcn26/project_pi_skr2/mcn26/boda2/src/vcf_predict.py', '--artifact_path', '/home/mcn26/scratch_pi_skr2/mcn26/sumner_pulldown/boda_ensembl_models/chr1_chr22/model_artifacts__20230111_190417__993143.tar.gz', '/home/mcn26/scratch_pi_skr2/mcn26/sumner_pulldown/boda_ensembl_models/chr1_chr22/model_artifacts__20230111_192235__715916.tar.gz', '/home/mcn26/scratch_pi_skr2/mcn26/sumner_pulldown/boda_ensembl_models/chr1_chr22/model_artifacts__20230111_232551__863644.tar.gz', '/home/mcn26/scratch_pi_skr2/mcn26/sumner_pulldown/boda_ensembl_models/chr1_chr22/model_artifacts__20230112_000934__941678.tar.gz', '/home/mcn26/scratch_pi_skr2/mcn26/sumner_pulldown/boda_ensembl_models/chr1_chr22/model_artifacts__20230112_003327__287605.tar.gz', '/home/mcn26/scratch_pi_skr2/mcn26/sumner_pulldown/boda_ensembl_models/chr1_chr22/model_artifacts__20230112_003539__758935.tar.gz', '/home/mcn26/scratch_pi_skr2/mcn26/sumner_pulldown/boda_ensembl_models/chr1_chr22/model_artifacts__20230112_014853__150994.tar.gz', '/home/mcn26/scratch_pi_skr2/mcn26/sumner_pulldown/boda_ensembl_models/chr1_chr22/model_artifacts__20230112_020038__431749.tar.gz', '/home/mcn26/scratch_pi_skr2/mcn26/sumner_pulldown/boda_ensembl_models/chr1_chr22/model_artifacts__20230112_024037__325298.tar.gz', '/home/mcn26/scratch_pi_skr2/mcn26/sumner_pulldown/boda_ensembl_models/chr1_chr22/model_artifacts__20230112_182326__436818.tar.gz', '--use_vmap', 'TRUE', '--vcf_file', '/home/mcn26/scratch_pi_skr2/mcn26/sumner_pulldown/chr1_chr22/GRCh38-dELS-chr1_chr22chunk_toy.tsv', '--fasta_file', '/home/mcn26/scratch_pi_skr2/mcn26/GRCh38_no_alt_analysis_set_GCA_000001405.15.fasta', '--output', '/home/mcn26/scratch_pi_skr2/mcn26/output/5000_chr1_chr22/chunk_toy.vcf', '--relative_start', '9', '--relative_end', '181', '--step_size', '10', '--raw_predictions', 'FALSE', '--strand_reduction', 'mean', '--window_reduction', 'mean', '--feature_ids', 'K562', 'HepG2', 'SKNSH']
Loaded model from 20230111_190417 in eval mode
Loaded model from 20230111_192235 in eval mode
Loaded model from 20230111_232551 in eval mode
Loaded model from 20230112_000934 in eval mode
Loaded model from 20230112_003327 in eval mode
Loaded model from 20230112_003539 in eval mode
Loaded model from 20230112_014853 in eval mode
Loaded model from 20230112_020038 in eval mode
Loaded model from 20230112_024037 in eval mode
Loaded model from 20230112_182326 in eval mode
  0%|          | 0/44284892 [00:00<?, ?it/s]  1%|          | 517487/44284892 [00:00<00:08, 5174665.20it/s]  3%|▎         | 1159928/44284892 [00:00<00:07, 5909684.50it/s]  4%|▍         | 1829593/44284892 [00:00<00:06, 6268936.58it/s]  6%|▌         | 2510142/44284892 [00:00<00:06, 6480680.78it/s]  7%|▋         | 3186711/44284892 [00:00<00:06, 6583372.45it/s]  9%|▉         | 3875420/44284892 [00:00<00:06, 6686576.95it/s] 10%|█         | 4567593/44284892 [00:00<00:05, 6763407.12it/s] 12%|█▏        | 5243934/44284892 [00:00<00:05, 6657434.04it/s] 13%|█▎        | 5930709/44284892 [00:00<00:05, 6722402.14it/s] 15%|█▍        | 6618746/44284892 [00:01<00:05, 6770750.77it/s] 17%|█▋        | 7308288/44284892 [00:01<00:05, 6808653.75it/s] 18%|█▊        | 8000570/44284892 [00:01<00:05, 6843209.91it/s] 20%|█▉        | 8693952/44284892 [00:01<00:05, 6870531.32it/s] 21%|██        | 9386405/44284892 [00:01<00:05, 6886730.15it/s] 23%|██▎       | 10081529/44284892 [00:01<00:04, 6906103.33it/s] 24%|██▍       | 10774215/44284892 [00:01<00:04, 6912283.11it/s] 26%|██▌       | 11470288/44284892 [00:01<00:04, 6926774.45it/s] 27%|██▋       | 12165234/44284892 [00:01<00:04, 6933540.52it/s] 29%|██▉       | 12861292/44284892 [00:01<00:04, 6941596.44it/s] 31%|███       | 13555949/44284892 [00:02<00:04, 6943036.69it/s] 32%|███▏      | 14253137/44284892 [00:02<00:04, 6951645.34it/s] 34%|███▍      | 14948309/44284892 [00:02<00:04, 6943418.44it/s] 35%|███▌      | 15646644/44284892 [00:02<00:04, 6955327.58it/s] 37%|███▋      | 16342183/44284892 [00:02<00:04, 6954145.13it/s] 38%|███▊      | 17039392/44284892 [00:02<00:03, 6959473.48it/s] 40%|████      | 17736717/44284892 [00:02<00:03, 6963557.34it/s] 42%|████▏     | 18433076/44284892 [00:02<00:03, 6961846.61it/s] 43%|████▎     | 19130880/44284892 [00:02<00:03, 6966655.20it/s] 45%|████▍     | 19827927/44284892 [00:02<00:03, 6967751.54it/s] 46%|████▋     | 20526711/44284892 [00:03<00:03, 6973724.19it/s] 48%|████▊     | 21224085/44284892 [00:03<00:03, 6960425.09it/s] 49%|████▉     | 21920134/44284892 [00:03<00:03, 6959134.32it/s] 51%|█████     | 22619160/44284892 [00:03<00:03, 6968408.71it/s] 53%|█████▎    | 23316005/44284892 [00:03<00:03, 6960563.18it/s] 54%|█████▍    | 24013721/44284892 [00:03<00:02, 6965487.76it/s] 56%|█████▌    | 24711485/44284892 [00:03<00:02, 6969077.19it/s] 57%|█████▋    | 25411776/44284892 [00:03<00:02, 6979177.34it/s] 59%|█████▉    | 26110475/44284892 [00:03<00:02, 6981472.12it/s] 61%|██████    | 26808625/44284892 [00:03<00:02, 6965336.26it/s] 62%|██████▏   | 27506903/44284892 [00:04<00:02, 6970506.93it/s] 64%|██████▎   | 28205460/44284892 [00:04<00:02, 6974972.12it/s] 65%|██████▌   | 28902964/44284892 [00:04<00:02, 6972079.85it/s] 67%|██████▋   | 29600177/44284892 [00:04<00:02, 6957519.69it/s] 68%|██████▊   | 30298219/44284892 [00:04<00:02, 6964327.51it/s] 70%|██████▉   | 30996738/44284892 [00:04<00:01, 6970529.15it/s] 72%|███████▏  | 31694739/44284892 [00:04<00:01, 6973312.63it/s] 73%|███████▎  | 32392357/44284892 [00:04<00:01, 6974119.37it/s] 75%|███████▍  | 33091301/44284892 [00:04<00:01, 6978655.28it/s] 76%|███████▋  | 33789170/44284892 [00:04<00:01, 6960175.18it/s] 78%|███████▊  | 34487097/44284892 [00:05<00:01, 6965828.86it/s] 79%|███████▉  | 35184642/44284892 [00:05<00:01, 6968653.17it/s] 81%|████████  | 35882043/44284892 [00:05<00:01, 6970215.71it/s] 83%|████████▎ | 36579234/44284892 [00:05<00:01, 6970675.79it/s] 84%|████████▍ | 37276306/44284892 [00:05<00:01, 6960554.97it/s] 86%|████████▌ | 37972368/44284892 [00:05<00:00, 6960223.47it/s] 87%|████████▋ | 38668787/44284892 [00:05<00:00, 6961359.50it/s] 89%|████████▉ | 39365693/44284892 [00:05<00:00, 6963610.28it/s] 90%|█████████ | 40063627/44284892 [00:05<00:00, 6968274.02it/s] 92%|█████████▏| 40762340/44284892 [00:05<00:00, 6973875.95it/s] 94%|█████████▎| 41461723/44284892 [00:06<00:00, 6979807.73it/s] 95%|█████████▌| 42159705/44284892 [00:06<00:00, 6956794.20it/s] 97%|█████████▋| 42856807/44284892 [00:06<00:00, 6961003.85it/s] 98%|█████████▊| 43555742/44284892 [00:06<00:00, 6969440.38it/s]100%|█████████▉| 44254664/44284892 [00:06<00:00, 6975314.29it/s]100%|██████████| 44284892/44284892 [00:06<00:00, 6902983.76it/s]
finding keys
parsing
  0%|          | 0/195 [00:00<?, ?it/s]  1%|          | 1/195 [00:28<1:30:32, 28.00s/it]  1%|          | 2/195 [00:55<1:28:48, 27.61s/it]  2%|▏         | 3/195 [01:17<1:20:38, 25.20s/it]  2%|▏         | 4/195 [01:39<1:15:26, 23.70s/it]  3%|▎         | 5/195 [01:59<1:11:17, 22.51s/it]  3%|▎         | 6/195 [02:18<1:07:24, 21.40s/it]  4%|▎         | 7/195 [02:36<1:03:27, 20.25s/it]  4%|▍         | 8/195 [02:52<59:12, 19.00s/it]    5%|▍         | 9/195 [03:08<55:31, 17.91s/it]  5%|▌         | 10/195 [03:23<52:28, 17.02s/it]  6%|▌         | 11/195 [03:38<50:26, 16.45s/it]  6%|▌         | 12/195 [03:53<48:53, 16.03s/it]  7%|▋         | 13/195 [04:06<45:37, 15.04s/it]  7%|▋         | 14/195 [04:18<42:32, 14.10s/it]  8%|▊         | 15/195 [04:29<39:48, 13.27s/it]  8%|▊         | 16/195 [04:39<36:43, 12.31s/it]  9%|▊         | 17/195 [04:49<33:52, 11.42s/it]  9%|▉         | 18/195 [04:58<31:30, 10.68s/it] 10%|▉         | 19/195 [05:04<27:41,  9.44s/it] 10%|█         | 20/195 [05:11<25:36,  8.78s/it] 11%|█         | 21/195 [05:17<22:19,  7.70s/it] 11%|█▏        | 22/195 [05:22<20:23,  7.07s/it] 12%|█▏        | 23/195 [05:40<29:14, 10.20s/it] 12%|█▏        | 24/195 [05:46<25:37,  8.99s/it] 18%|█▊        | 35/195 [05:46<04:12,  1.58s/it] 22%|██▏       | 43/195 [05:46<02:10,  1.17it/s] 25%|██▌       | 49/195 [05:46<01:24,  1.73it/s] 28%|██▊       | 55/195 [05:46<00:57,  2.44it/s] 31%|███▏      | 61/195 [05:47<00:38,  3.50it/s] 47%|████▋     | 92/195 [05:47<00:09, 11.27it/s] 87%|████████▋ | 169/195 [05:47<00:00, 37.85it/s]100%|██████████| 195/195 [05:47<00:00,  1.78s/it]
done
loading DataFrame
loaded shape: (9, 5)
Checking and filtering tokens
passed shape: (9, 5)
Allele length checks
final shape: (9, 5)
Done
9/9 records have matching contig in FASTA
returned 9/9 records
Dataset length: 9, VCF length: (9, 5)
  0%|          | 0/1 [00:00<?, ?it/s]/home/mcn26/.conda/envs/boda_fresh/lib/python3.7/site-packages/torch/nn/functional.py:696: UserWarning: There is a performance drop because we have not yet implemented the batching rule for aten::max_pool1d. Please file us an issue on GitHub so that we can prioritize its implementation. (Triggered internally at ../aten/src/ATen/functorch/BatchedFallback.cpp:82.)
  return torch.max_pool1d(input, kernel_size, stride, padding, dilation, ceil_mode)
100%|██████████| 1/1 [00:01<00:00,  1.13s/it]100%|██████████| 1/1 [00:01<00:00,  1.13s/it]
ref dims: torch.Size([9, 3]), alt dims: torch.Size([9, 3]), skew dims: torch.Size([9, 3])
results table shape: (9,)
[+] Finished!
