srun: warning: can't run 1 processes on 2 nodes, setting nnodes to 1
[+] Making ./chr2_chr21/chunk_11 
[*] Running chunk 11 on host: a1126u11n01.mghpcc.ycrc.yale.edu with CUDA_VISIBLE_DEVICES=0
/home/mcn26/.conda/envs/boda_cu128/lib/python3.11/site-packages/lightning/fabric/__init__.py:29: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  __import__("pkg_resources").declare_namespace(__name__)
archive unpacked in ./
archive unpacked in ./
archive unpacked in ./
archive unpacked in ./
archive unpacked in ./
archive unpacked in ./
archive unpacked in ./
archive unpacked in ./
archive unpacked in ./
archive unpacked in ./
/home/mcn26/scratch_pi_skr2/mcn26/sumner_pulldown/boda2/src/vcf_predict.py:102: FutureWarning: We've integrated functorch into PyTorch. As the final step of the integration, `functorch.combine_state_for_ensemble` is deprecated as of PyTorch 2.0 and will be deleted in a future version of PyTorch >= 2.3. Please use `torch.func.stack_module_state` instead; see the PyTorch 2.0 release notes and/or the `torch.func` migration guide for more details https://pytorch.org/docs/main/func.migrating.html
  self.fmodel, self.params, self.buffers = combine_state_for_ensemble(models)
pre-reading fasta into memory
['/home/mcn26/scratch_pi_skr2/mcn26/sumner_pulldown/boda2/src/vcf_predict.py', '--artifact_path', '/home/mcn26/scratch_pi_skr2/mcn26/sumner_pulldown/boda_ensembl_models/chr2_chr21/model_artifacts__20230111_233731__117900.tar.gz', '/home/mcn26/scratch_pi_skr2/mcn26/sumner_pulldown/boda_ensembl_models/chr2_chr21/model_artifacts__20230112_002409__248129.tar.gz', '/home/mcn26/scratch_pi_skr2/mcn26/sumner_pulldown/boda_ensembl_models/chr2_chr21/model_artifacts__20230112_003824__879872.tar.gz', '/home/mcn26/scratch_pi_skr2/mcn26/sumner_pulldown/boda_ensembl_models/chr2_chr21/model_artifacts__20230112_004119__145637.tar.gz', '/home/mcn26/scratch_pi_skr2/mcn26/sumner_pulldown/boda_ensembl_models/chr2_chr21/model_artifacts__20230112_005430__748782.tar.gz', '/home/mcn26/scratch_pi_skr2/mcn26/sumner_pulldown/boda_ensembl_models/chr2_chr21/model_artifacts__20230112_014533__217034.tar.gz', '/home/mcn26/scratch_pi_skr2/mcn26/sumner_pulldown/boda_ensembl_models/chr2_chr21/model_artifacts__20230112_023910__737605.tar.gz', '/home/mcn26/scratch_pi_skr2/mcn26/sumner_pulldown/boda_ensembl_models/chr2_chr21/model_artifacts__20230112_031741__363749.tar.gz', '/home/mcn26/scratch_pi_skr2/mcn26/sumner_pulldown/boda_ensembl_models/chr2_chr21/model_artifacts__20230112_041842__826676.tar.gz', '/home/mcn26/scratch_pi_skr2/mcn26/sumner_pulldown/boda_ensembl_models/chr2_chr21/model_artifacts__20230112_173424__415672.tar.gz', '--use_vmap', 'TRUE', '--vcf_file', '/home/mcn26/scratch_pi_skr2/mcn26/sumner_pulldown/chr2_chr21/GRCh38-dELS-chr2_chr21chunk_11.tsv', '--fasta_file', '/home/mcn26/scratch_pi_skr2/mcn26/GRCh38_no_alt_analysis_set_GCA_000001405.15.fasta', '--output', '/home/mcn26/scratch_pi_skr2/mcn26/output/chr2_chr21/chunk_11.vcf', '--relative_start', '9', '--relative_end', '181', '--step_size', '10', '--raw_predictions', 'FALSE', '--strand_reduction', 'mean', '--window_reduction', 'mean', '--feature_ids', 'K562', 'HepG2', 'SKNSH']
Loaded model from 20230111_233731 in eval mode
Loaded model from 20230112_002409 in eval mode
Loaded model from 20230112_003824 in eval mode
Loaded model from 20230112_004119 in eval mode
Loaded model from 20230112_005430 in eval mode
Loaded model from 20230112_014533 in eval mode
Loaded model from 20230112_023910 in eval mode
Loaded model from 20230112_031741 in eval mode
Loaded model from 20230112_041842 in eval mode
Loaded model from 20230112_173424 in eval mode
  0%|          | 0/44284892 [00:00<?, ?it/s]  1%|▏         | 627427/44284892 [00:00<00:06, 6273931.94it/s]  3%|▎         | 1396183/44284892 [00:00<00:06, 7105313.93it/s]  5%|▍         | 2198300/44284892 [00:00<00:05, 7523391.96it/s]  7%|▋         | 2984934/44284892 [00:00<00:05, 7658675.65it/s]  9%|▊         | 3791604/44284892 [00:00<00:05, 7805717.47it/s] 10%|█         | 4572177/44284892 [00:00<00:05, 7760794.30it/s] 12%|█▏        | 5348307/44284892 [00:00<00:05, 7541886.18it/s] 14%|█▍        | 6112353/44284892 [00:00<00:05, 7572448.49it/s] 16%|█▌        | 6870459/44284892 [00:00<00:05, 7406052.20it/s] 17%|█▋        | 7672912/44284892 [00:01<00:04, 7591979.67it/s] 19%|█▉        | 8481834/44284892 [00:01<00:04, 7741350.91it/s] 21%|██        | 9298893/44284892 [00:01<00:04, 7870221.76it/s] 23%|██▎       | 10113169/44284892 [00:01<00:04, 7952008.43it/s] 25%|██▍       | 10938055/44284892 [00:01<00:04, 8041061.96it/s] 27%|██▋       | 11761885/44284892 [00:01<00:04, 8100205.38it/s] 28%|██▊       | 12589535/44284892 [00:01<00:03, 8153062.88it/s] 30%|███       | 13416438/44284892 [00:01<00:03, 8187808.70it/s] 32%|███▏      | 14241243/44284892 [00:01<00:03, 8205838.60it/s] 34%|███▍      | 15073783/44284892 [00:01<00:03, 8241665.03it/s] 36%|███▌      | 15900650/44284892 [00:02<00:03, 8249727.99it/s] 38%|███▊      | 16729958/44284892 [00:02<00:03, 8262665.46it/s] 40%|███▉      | 17556284/44284892 [00:02<00:03, 8061498.61it/s] 41%|████▏     | 18363551/44284892 [00:02<00:03, 7792820.94it/s] 43%|████▎     | 19145179/44284892 [00:02<00:03, 7512991.97it/s] 45%|████▌     | 19933906/44284892 [00:02<00:03, 7619523.40it/s] 47%|████▋     | 20744908/44284892 [00:02<00:03, 7761309.92it/s] 49%|████▊     | 21561836/44284892 [00:02<00:02, 7880517.68it/s] 51%|█████     | 22384767/44284892 [00:02<00:02, 7983220.99it/s] 52%|█████▏    | 23200931/44284892 [00:02<00:02, 8036016.61it/s] 54%|█████▍    | 24021172/44284892 [00:03<00:02, 8085455.86it/s] 56%|█████▌    | 24850153/44284892 [00:03<00:02, 8146344.47it/s] 58%|█████▊    | 25676744/44284892 [00:03<00:02, 8182023.34it/s] 60%|█████▉    | 26508603/44284892 [00:03<00:02, 8222833.76it/s] 62%|██████▏   | 27339383/44284892 [00:03<00:02, 8248235.35it/s] 64%|██████▎   | 28169154/44284892 [00:03<00:01, 8263016.19it/s] 65%|██████▌   | 28996404/44284892 [00:03<00:01, 8265819.31it/s] 67%|██████▋   | 29823301/44284892 [00:03<00:01, 8266724.81it/s] 69%|██████▉   | 30650059/44284892 [00:03<00:01, 7767696.06it/s] 71%|███████   | 31468450/44284892 [00:03<00:01, 7887081.63it/s] 73%|███████▎  | 32283287/44284892 [00:04<00:01, 7963017.49it/s] 75%|███████▍  | 33108278/44284892 [00:04<00:01, 8047180.57it/s] 77%|███████▋  | 33934067/44284892 [00:04<00:01, 8109391.90it/s] 78%|███████▊  | 34760800/44284892 [00:04<00:01, 8156224.07it/s] 80%|████████  | 35588442/44284892 [00:04<00:01, 8191971.16it/s] 82%|████████▏ | 36416556/44284892 [00:04<00:00, 8218540.87it/s] 84%|████████▍ | 37242019/44284892 [00:04<00:00, 8229288.48it/s] 86%|████████▌ | 38068297/44284892 [00:04<00:00, 8239270.82it/s] 88%|████████▊ | 38901930/44284892 [00:04<00:00, 8268296.07it/s] 90%|████████▉ | 39737215/44284892 [00:04<00:00, 8293590.40it/s] 92%|█████████▏| 40569478/44284892 [00:05<00:00, 8302261.15it/s] 93%|█████████▎| 41399838/44284892 [00:05<00:00, 8300967.93it/s] 95%|█████████▌| 42236156/44284892 [00:05<00:00, 8319587.24it/s] 97%|█████████▋| 43068182/44284892 [00:05<00:00, 8184157.44it/s] 99%|█████████▉| 43887136/44284892 [00:05<00:00, 7770720.90it/s]100%|██████████| 44284892/44284892 [00:05<00:00, 7986828.00it/s]
finding keys
parsing
