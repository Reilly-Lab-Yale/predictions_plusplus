srun: warning: can't run 1 processes on 2 nodes, setting nnodes to 1
[+] Making ./chr2_chr21/chunk_4 
[*] Running chunk 4 on host: a1126u19n01.mghpcc.ycrc.yale.edu with CUDA_VISIBLE_DEVICES=0
/home/mcn26/.conda/envs/boda_cu128/lib/python3.11/site-packages/lightning/fabric/__init__.py:29: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  __import__("pkg_resources").declare_namespace(__name__)
archive unpacked in ./
archive unpacked in ./
archive unpacked in ./
archive unpacked in ./
archive unpacked in ./
archive unpacked in ./
archive unpacked in ./
archive unpacked in ./
archive unpacked in ./
archive unpacked in ./
/home/mcn26/scratch_pi_skr2/mcn26/sumner_pulldown/boda2/src/vcf_predict.py:102: FutureWarning: We've integrated functorch into PyTorch. As the final step of the integration, `functorch.combine_state_for_ensemble` is deprecated as of PyTorch 2.0 and will be deleted in a future version of PyTorch >= 2.3. Please use `torch.func.stack_module_state` instead; see the PyTorch 2.0 release notes and/or the `torch.func` migration guide for more details https://pytorch.org/docs/main/func.migrating.html
  self.fmodel, self.params, self.buffers = combine_state_for_ensemble(models)
pre-reading fasta into memory
['/home/mcn26/scratch_pi_skr2/mcn26/sumner_pulldown/boda2/src/vcf_predict.py', '--artifact_path', '/home/mcn26/scratch_pi_skr2/mcn26/sumner_pulldown/boda_ensembl_models/chr2_chr21/model_artifacts__20230111_233731__117900.tar.gz', '/home/mcn26/scratch_pi_skr2/mcn26/sumner_pulldown/boda_ensembl_models/chr2_chr21/model_artifacts__20230112_002409__248129.tar.gz', '/home/mcn26/scratch_pi_skr2/mcn26/sumner_pulldown/boda_ensembl_models/chr2_chr21/model_artifacts__20230112_003824__879872.tar.gz', '/home/mcn26/scratch_pi_skr2/mcn26/sumner_pulldown/boda_ensembl_models/chr2_chr21/model_artifacts__20230112_004119__145637.tar.gz', '/home/mcn26/scratch_pi_skr2/mcn26/sumner_pulldown/boda_ensembl_models/chr2_chr21/model_artifacts__20230112_005430__748782.tar.gz', '/home/mcn26/scratch_pi_skr2/mcn26/sumner_pulldown/boda_ensembl_models/chr2_chr21/model_artifacts__20230112_014533__217034.tar.gz', '/home/mcn26/scratch_pi_skr2/mcn26/sumner_pulldown/boda_ensembl_models/chr2_chr21/model_artifacts__20230112_023910__737605.tar.gz', '/home/mcn26/scratch_pi_skr2/mcn26/sumner_pulldown/boda_ensembl_models/chr2_chr21/model_artifacts__20230112_031741__363749.tar.gz', '/home/mcn26/scratch_pi_skr2/mcn26/sumner_pulldown/boda_ensembl_models/chr2_chr21/model_artifacts__20230112_041842__826676.tar.gz', '/home/mcn26/scratch_pi_skr2/mcn26/sumner_pulldown/boda_ensembl_models/chr2_chr21/model_artifacts__20230112_173424__415672.tar.gz', '--use_vmap', 'TRUE', '--vcf_file', '/home/mcn26/scratch_pi_skr2/mcn26/sumner_pulldown/chr2_chr21/GRCh38-dELS-chr2_chr21chunk_4.tsv', '--fasta_file', '/home/mcn26/scratch_pi_skr2/mcn26/GRCh38_no_alt_analysis_set_GCA_000001405.15.fasta', '--output', '/home/mcn26/scratch_pi_skr2/mcn26/output/chr2_chr21/chunk_4.vcf', '--relative_start', '9', '--relative_end', '181', '--step_size', '10', '--raw_predictions', 'FALSE', '--strand_reduction', 'mean', '--window_reduction', 'mean', '--feature_ids', 'K562', 'HepG2', 'SKNSH']
Loaded model from 20230111_233731 in eval mode
Loaded model from 20230112_002409 in eval mode
Loaded model from 20230112_003824 in eval mode
Loaded model from 20230112_004119 in eval mode
Loaded model from 20230112_005430 in eval mode
Loaded model from 20230112_014533 in eval mode
Loaded model from 20230112_023910 in eval mode
Loaded model from 20230112_031741 in eval mode
Loaded model from 20230112_041842 in eval mode
Loaded model from 20230112_173424 in eval mode
  0%|          | 0/44284892 [00:00<?, ?it/s]  1%|▏         | 640415/44284892 [00:00<00:06, 6403835.48it/s]  3%|▎         | 1421878/44284892 [00:00<00:05, 7233519.28it/s]  5%|▌         | 2234944/44284892 [00:00<00:05, 7643074.38it/s]  7%|▋         | 3063749/44284892 [00:00<00:05, 7897604.33it/s]  9%|▊         | 3862068/44284892 [00:00<00:05, 7928387.41it/s] 11%|█         | 4654908/44284892 [00:00<00:05, 7713826.26it/s] 12%|█▏        | 5452008/44284892 [00:00<00:04, 7796298.84it/s] 14%|█▍        | 6232513/44284892 [00:00<00:04, 7627477.04it/s] 16%|█▌        | 7061294/44284892 [00:00<00:04, 7828944.32it/s] 18%|█▊        | 7899295/44284892 [00:01<00:04, 7996169.42it/s] 20%|█▉        | 8741202/44284892 [00:01<00:04, 8124059.06it/s] 22%|██▏       | 9587516/44284892 [00:01<00:04, 8226330.43it/s] 24%|██▎       | 10436294/44284892 [00:01<00:04, 8305044.63it/s] 25%|██▌       | 11286037/44284892 [00:01<00:03, 8362872.42it/s] 27%|██▋       | 12141446/44284892 [00:01<00:03, 8420287.33it/s] 29%|██▉       | 12994158/44284892 [00:01<00:03, 8452329.29it/s] 31%|███▏      | 13850360/44284892 [00:01<00:03, 8485228.05it/s] 33%|███▎      | 14706073/44284892 [00:01<00:03, 8506772.89it/s] 35%|███▌      | 15565969/44284892 [00:01<00:03, 8534395.47it/s] 37%|███▋      | 16422330/44284892 [00:02<00:03, 8543116.20it/s] 39%|███▉      | 17281838/44284892 [00:02<00:03, 8558656.13it/s] 41%|████      | 18138741/44284892 [00:02<00:03, 8561697.71it/s] 43%|████▎     | 19000575/44284892 [00:02<00:02, 8578657.73it/s] 45%|████▍     | 19858462/44284892 [00:02<00:02, 8425480.96it/s] 47%|████▋     | 20701636/44284892 [00:02<00:02, 8085217.37it/s] 49%|████▊     | 21513191/44284892 [00:02<00:02, 7800136.06it/s] 50%|█████     | 22333590/44284892 [00:02<00:02, 7914978.06it/s] 52%|█████▏    | 23170848/44284892 [00:02<00:02, 8047167.25it/s] 54%|█████▍    | 24017482/44284892 [00:02<00:02, 8169580.94it/s] 56%|█████▌    | 24867705/44284892 [00:03<00:02, 8267501.64it/s] 58%|█████▊    | 25716132/44284892 [00:03<00:02, 8331651.11it/s] 60%|█████▉    | 26569468/44284892 [00:03<00:02, 8391573.59it/s] 62%|██████▏   | 27425410/44284892 [00:03<00:01, 8441565.97it/s] 64%|██████▍   | 28283924/44284892 [00:03<00:01, 8484392.93it/s] 66%|██████▌   | 29137909/44284892 [00:03<00:01, 8500943.71it/s] 68%|██████▊   | 29996622/44284892 [00:03<00:01, 8526708.38it/s] 70%|██████▉   | 30857453/44284892 [00:03<00:01, 8551086.18it/s] 72%|███████▏  | 31718888/44284892 [00:03<00:01, 8570010.32it/s] 74%|███████▎  | 32576020/44284892 [00:03<00:01, 8568653.89it/s] 76%|███████▌  | 33438218/44284892 [00:04<00:01, 8584594.21it/s] 77%|███████▋  | 34300826/44284892 [00:04<00:01, 8597005.71it/s] 79%|███████▉  | 35162471/44284892 [00:04<00:01, 8602753.37it/s] 81%|████████▏ | 36025184/44284892 [00:04<00:00, 8610005.47it/s] 83%|████████▎ | 36886208/44284892 [00:04<00:00, 8593491.66it/s] 85%|████████▌ | 37748543/44284892 [00:04<00:00, 8602395.43it/s] 87%|████████▋ | 38611325/44284892 [00:04<00:00, 8609974.31it/s] 89%|████████▉ | 39472986/44284892 [00:04<00:00, 8611898.32it/s] 91%|█████████ | 40335943/44284892 [00:04<00:00, 8617156.44it/s] 93%|█████████▎| 41197666/44284892 [00:04<00:00, 8589636.09it/s] 95%|█████████▍| 42059061/44284892 [00:05<00:00, 8596877.73it/s] 97%|█████████▋| 42921749/44284892 [00:05<00:00, 8605828.25it/s] 99%|█████████▉| 43784606/44284892 [00:05<00:00, 8612607.94it/s]100%|██████████| 44284892/44284892 [00:05<00:00, 8341972.71it/s]
finding keys
parsing
