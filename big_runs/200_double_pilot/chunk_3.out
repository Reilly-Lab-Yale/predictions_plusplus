srun: warning: can't run 1 processes on 2 nodes, setting nnodes to 1
[+] Making ./chr2_chr21/chunk_3 
[*] Running chunk 3 on host: a1124u11n01.mghpcc.ycrc.yale.edu with CUDA_VISIBLE_DEVICES=0
/home/mcn26/.conda/envs/boda_cu128/lib/python3.11/site-packages/lightning/fabric/__init__.py:29: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  __import__("pkg_resources").declare_namespace(__name__)
archive unpacked in ./
archive unpacked in ./
archive unpacked in ./
archive unpacked in ./
archive unpacked in ./
archive unpacked in ./
archive unpacked in ./
archive unpacked in ./
archive unpacked in ./
archive unpacked in ./
/home/mcn26/scratch_pi_skr2/mcn26/sumner_pulldown/boda2/src/vcf_predict.py:102: FutureWarning: We've integrated functorch into PyTorch. As the final step of the integration, `functorch.combine_state_for_ensemble` is deprecated as of PyTorch 2.0 and will be deleted in a future version of PyTorch >= 2.3. Please use `torch.func.stack_module_state` instead; see the PyTorch 2.0 release notes and/or the `torch.func` migration guide for more details https://pytorch.org/docs/main/func.migrating.html
  self.fmodel, self.params, self.buffers = combine_state_for_ensemble(models)
pre-reading fasta into memory
['/home/mcn26/scratch_pi_skr2/mcn26/sumner_pulldown/boda2/src/vcf_predict.py', '--artifact_path', '/home/mcn26/scratch_pi_skr2/mcn26/sumner_pulldown/boda_ensembl_models/chr2_chr21/model_artifacts__20230111_233731__117900.tar.gz', '/home/mcn26/scratch_pi_skr2/mcn26/sumner_pulldown/boda_ensembl_models/chr2_chr21/model_artifacts__20230112_002409__248129.tar.gz', '/home/mcn26/scratch_pi_skr2/mcn26/sumner_pulldown/boda_ensembl_models/chr2_chr21/model_artifacts__20230112_003824__879872.tar.gz', '/home/mcn26/scratch_pi_skr2/mcn26/sumner_pulldown/boda_ensembl_models/chr2_chr21/model_artifacts__20230112_004119__145637.tar.gz', '/home/mcn26/scratch_pi_skr2/mcn26/sumner_pulldown/boda_ensembl_models/chr2_chr21/model_artifacts__20230112_005430__748782.tar.gz', '/home/mcn26/scratch_pi_skr2/mcn26/sumner_pulldown/boda_ensembl_models/chr2_chr21/model_artifacts__20230112_014533__217034.tar.gz', '/home/mcn26/scratch_pi_skr2/mcn26/sumner_pulldown/boda_ensembl_models/chr2_chr21/model_artifacts__20230112_023910__737605.tar.gz', '/home/mcn26/scratch_pi_skr2/mcn26/sumner_pulldown/boda_ensembl_models/chr2_chr21/model_artifacts__20230112_031741__363749.tar.gz', '/home/mcn26/scratch_pi_skr2/mcn26/sumner_pulldown/boda_ensembl_models/chr2_chr21/model_artifacts__20230112_041842__826676.tar.gz', '/home/mcn26/scratch_pi_skr2/mcn26/sumner_pulldown/boda_ensembl_models/chr2_chr21/model_artifacts__20230112_173424__415672.tar.gz', '--use_vmap', 'TRUE', '--vcf_file', '/home/mcn26/scratch_pi_skr2/mcn26/sumner_pulldown/chr2_chr21/GRCh38-dELS-chr2_chr21chunk_3.tsv', '--fasta_file', '/home/mcn26/scratch_pi_skr2/mcn26/GRCh38_no_alt_analysis_set_GCA_000001405.15.fasta', '--output', '/home/mcn26/scratch_pi_skr2/mcn26/output/chr2_chr21/chunk_3.vcf', '--relative_start', '9', '--relative_end', '181', '--step_size', '10', '--raw_predictions', 'FALSE', '--strand_reduction', 'mean', '--window_reduction', 'mean', '--feature_ids', 'K562', 'HepG2', 'SKNSH']
Loaded model from 20230111_233731 in eval mode
Loaded model from 20230112_002409 in eval mode
Loaded model from 20230112_003824 in eval mode
Loaded model from 20230112_004119 in eval mode
Loaded model from 20230112_005430 in eval mode
Loaded model from 20230112_014533 in eval mode
Loaded model from 20230112_023910 in eval mode
Loaded model from 20230112_031741 in eval mode
Loaded model from 20230112_041842 in eval mode
Loaded model from 20230112_173424 in eval mode
  0%|          | 0/44284892 [00:00<?, ?it/s]  1%|▏         | 649534/44284892 [00:00<00:06, 6495021.00it/s]  3%|▎         | 1458644/44284892 [00:00<00:05, 7433730.23it/s]  5%|▌         | 2238117/44284892 [00:00<00:05, 7598470.83it/s]  7%|▋         | 2997965/44284892 [00:00<00:05, 7486924.50it/s]  9%|▊         | 3830207/44284892 [00:00<00:05, 7785292.91it/s] 11%|█         | 4674456/44284892 [00:00<00:04, 8007279.07it/s] 12%|█▏        | 5525007/44284892 [00:00<00:04, 8169400.08it/s] 14%|█▍        | 6380468/44284892 [00:00<00:04, 8291554.83it/s] 16%|█▋        | 7242991/44284892 [00:00<00:04, 8395610.60it/s] 18%|█▊        | 8108976/44284892 [00:01<00:04, 8477032.42it/s] 20%|██        | 8975944/44284892 [00:01<00:04, 8535894.46it/s] 22%|██▏       | 9846599/44284892 [00:01<00:04, 8587733.51it/s] 24%|██▍       | 10715943/44284892 [00:01<00:03, 8619705.67it/s] 26%|██▌       | 11587794/44284892 [00:01<00:03, 8649492.08it/s] 28%|██▊       | 12462810/44284892 [00:01<00:03, 8679788.15it/s] 30%|███       | 13335184/44284892 [00:01<00:03, 8692949.32it/s] 32%|███▏      | 14204501/44284892 [00:01<00:03, 8554040.10it/s] 34%|███▍      | 15060417/44284892 [00:01<00:03, 8238187.35it/s] 36%|███▌      | 15919890/44284892 [00:01<00:03, 8341579.57it/s] 38%|███▊      | 16783429/44284892 [00:02<00:03, 8427628.85it/s] 40%|███▉      | 17627920/44284892 [00:02<00:03, 8124809.26it/s] 42%|████▏     | 18443559/44284892 [00:02<00:03, 8129980.43it/s] 44%|████▎     | 19302193/44284892 [00:02<00:03, 8263201.84it/s] 46%|████▌     | 20161198/44284892 [00:02<00:02, 8359364.61it/s] 47%|████▋     | 21025826/44284892 [00:02<00:02, 8444258.13it/s] 49%|████▉     | 21894482/44284892 [00:02<00:02, 8516212.87it/s] 51%|█████▏    | 22759605/44284892 [00:02<00:02, 8556406.45it/s] 53%|█████▎    | 23631654/44284892 [00:02<00:02, 8605364.71it/s] 55%|█████▌    | 24504750/44284892 [00:02<00:02, 8642887.21it/s] 57%|█████▋    | 25377176/44284892 [00:03<00:02, 8667184.41it/s] 59%|█████▉    | 26247191/44284892 [00:03<00:02, 8677005.07it/s] 61%|██████    | 27122705/44284892 [00:03<00:01, 8700372.10it/s] 63%|██████▎   | 27998419/44284892 [00:03<00:01, 8717335.49it/s] 65%|██████▌   | 28870243/44284892 [00:03<00:01, 8709098.55it/s] 67%|██████▋   | 29747425/44284892 [00:03<00:01, 8727853.66it/s] 69%|██████▉   | 30620258/44284892 [00:03<00:01, 8202692.28it/s] 71%|███████   | 31452565/44284892 [00:03<00:01, 8237177.83it/s] 73%|███████▎  | 32280970/44284892 [00:03<00:01, 7962615.02it/s] 75%|███████▍  | 33133542/44284892 [00:03<00:01, 8123702.31it/s] 77%|███████▋  | 33993174/44284892 [00:04<00:01, 8260804.43it/s] 79%|███████▊  | 34857061/44284892 [00:04<00:01, 8371552.20it/s] 81%|████████  | 35721640/44284892 [00:04<00:01, 8452434.60it/s] 83%|████████▎ | 36584264/44284892 [00:04<00:00, 8503931.25it/s] 85%|████████▍ | 37453319/44284892 [00:04<00:00, 8559412.46it/s] 87%|████████▋ | 38324999/44284892 [00:04<00:00, 8606320.52it/s] 89%|████████▊ | 39198823/44284892 [00:04<00:00, 8645698.19it/s] 90%|█████████ | 40073123/44284892 [00:04<00:00, 8674766.37it/s] 92%|█████████▏| 40943756/44284892 [00:04<00:00, 8684188.39it/s] 94%|█████████▍| 41818745/44284892 [00:04<00:00, 8703836.95it/s] 96%|█████████▋| 42695711/44284892 [00:05<00:00, 8723511.19it/s] 98%|█████████▊| 43573093/44284892 [00:05<00:00, 8738552.34it/s]100%|██████████| 44284892/44284892 [00:05<00:00, 8399762.44it/s]
finding keys
parsing
