[+] Making ./chr14/chunk_69
[*] Running chunk 69 on host: a1126u19n01.mghpcc.ycrc.yale.edu with CUDA_VISIBLE_DEVICES=0
/home/mcn26/.conda/envs/boda_cu128/lib/python3.11/site-packages/lightning/fabric/__init__.py:29: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  __import__("pkg_resources").declare_namespace(__name__)
archive unpacked in ./
archive unpacked in ./
archive unpacked in ./
archive unpacked in ./
archive unpacked in ./
archive unpacked in ./
archive unpacked in ./
archive unpacked in ./
archive unpacked in ./
archive unpacked in ./
/home/mcn26/project_pi_skr2/mcn26/boda2/src/vcf_predict_indel.py:86: FutureWarning: We've integrated functorch into PyTorch. As the final step of the integration, `functorch.combine_state_for_ensemble` is deprecated as of PyTorch 2.0 and will be deleted in a future version of PyTorch >= 2.3. Please use `torch.func.stack_module_state` instead; see the PyTorch 2.0 release notes and/or the `torch.func` migration guide for more details https://pytorch.org/docs/main/func.migrating.html
  self.fmodel, self.params, self.buffers = combine_state_for_ensemble(models)
pre-reading fasta into memory
  0%|          | 0/44284892 [00:00<?, ?it/s]  1%|▏         | 650358/44284892 [00:00<00:06, 6503152.07it/s]  3%|▎         | 1414161/44284892 [00:00<00:05, 7170542.30it/s]  5%|▍         | 2131216/44284892 [00:00<00:05, 7133011.57it/s]  7%|▋         | 2906370/44284892 [00:00<00:05, 7376312.47it/s]  8%|▊         | 3644093/44284892 [00:00<00:05, 7267094.49it/s] 10%|█         | 4469179/44284892 [00:00<00:05, 7597752.60it/s] 12%|█▏        | 5305828/44284892 [00:00<00:04, 7847079.14it/s] 14%|█▍        | 6151986/44284892 [00:00<00:04, 8041562.02it/s] 16%|█▌        | 7001587/44284892 [00:00<00:04, 8183068.60it/s] 18%|█▊        | 7856071/44284892 [00:01<00:04, 8294431.47it/s] 20%|█▉        | 8717823/44284892 [00:01<00:04, 8393071.55it/s] 22%|██▏       | 9580357/44284892 [00:01<00:04, 8463604.25it/s] 24%|██▎       | 10444193/44284892 [00:01<00:03, 8516464.71it/s] 26%|██▌       | 11308778/44284892 [00:01<00:03, 8555481.52it/s] 27%|██▋       | 12178224/44284892 [00:01<00:03, 8597321.86it/s] 29%|██▉       | 13046156/44284892 [00:01<00:03, 8621955.22it/s] 31%|███▏      | 13916784/44284892 [00:01<00:03, 8647259.22it/s] 33%|███▎      | 14781541/44284892 [00:01<00:03, 8491064.92it/s] 35%|███▌      | 15631298/44284892 [00:01<00:03, 8186053.98it/s] 37%|███▋      | 16485853/44284892 [00:02<00:03, 8290234.15it/s] 39%|███▉      | 17316997/44284892 [00:02<00:03, 8041322.22it/s] 41%|████      | 18165213/44284892 [00:02<00:03, 8168465.86it/s] 43%|████▎     | 19024220/44284892 [00:02<00:03, 8291461.04it/s] 45%|████▍     | 19886677/44284892 [00:02<00:02, 8389435.57it/s] 47%|████▋     | 20746815/44284892 [00:02<00:02, 8452110.24it/s] 49%|████▉     | 21613117/44284892 [00:02<00:02, 8514725.34it/s] 51%|█████     | 22482079/44284892 [00:02<00:02, 8566798.00it/s] 53%|█████▎    | 23348060/44284892 [00:02<00:02, 8594518.51it/s] 55%|█████▍    | 24219191/44284892 [00:02<00:02, 8629394.22it/s] 57%|█████▋    | 25089041/44284892 [00:03<00:02, 8650037.46it/s] 59%|█████▊    | 25959497/44284892 [00:03<00:02, 8666320.75it/s] 61%|██████    | 26832791/44284892 [00:03<00:02, 8686218.04it/s] 63%|██████▎   | 27701538/44284892 [00:03<00:01, 8666472.21it/s] 65%|██████▍   | 28568282/44284892 [00:03<00:01, 8204401.44it/s] 66%|██████▋   | 29393830/44284892 [00:03<00:01, 7950565.37it/s] 68%|██████▊   | 30210486/44284892 [00:03<00:01, 8012018.04it/s] 70%|███████   | 31063609/44284892 [00:03<00:01, 8162129.23it/s] 72%|███████▏  | 31922907/44284892 [00:03<00:01, 8288046.02it/s] 74%|███████▍  | 32776904/44284892 [00:03<00:01, 8362207.71it/s] 76%|███████▌  | 33642019/44284892 [00:04<00:01, 8447747.55it/s] 78%|███████▊  | 34507126/44284892 [00:04<00:01, 8508149.52it/s] 80%|███████▉  | 35375231/44284892 [00:04<00:01, 8559643.09it/s] 82%|████████▏ | 36239912/44284892 [00:04<00:00, 8585619.72it/s] 84%|████████▍ | 37109613/44284892 [00:04<00:00, 8618887.15it/s] 86%|████████▌ | 37982478/44284892 [00:04<00:00, 8651710.22it/s] 88%|████████▊ | 38855457/44284892 [00:04<00:00, 8675063.92it/s] 90%|████████▉ | 39727666/44284892 [00:04<00:00, 8689109.53it/s] 92%|█████████▏| 40601418/44284892 [00:04<00:00, 8703574.50it/s] 94%|█████████▎| 41471875/44284892 [00:04<00:00, 8131376.48it/s] 96%|█████████▌| 42331726/44284892 [00:05<00:00, 8264846.65it/s] 97%|█████████▋| 43164237/44284892 [00:05<00:00, 7911252.33it/s] 99%|█████████▉| 44016040/44284892 [00:05<00:00, 8083212.92it/s]100%|██████████| 44284892/44284892 [00:05<00:00, 8297494.78it/s]
finding keys
parsing
  0%|          | 0/195 [00:00<?, ?it/s]  1%|          | 1/195 [00:26<1:27:17, 27.00s/it]  1%|          | 2/195 [00:53<1:26:13, 26.80s/it]  2%|▏         | 3/195 [01:15<1:18:08, 24.42s/it]  2%|▏         | 4/195 [01:36<1:13:08, 22.98s/it]  3%|▎         | 5/195 [01:55<1:09:05, 21.82s/it]  3%|▎         | 6/195 [02:14<1:05:22, 20.76s/it]  4%|▎         | 7/195 [02:31<1:01:40, 19.68s/it]  4%|▍         | 8/195 [02:47<57:38, 18.49s/it]    5%|▍         | 9/195 [03:02<53:52, 17.38s/it]  5%|▌         | 10/195 [03:17<51:02, 16.55s/it]  6%|▌         | 11/195 [03:32<49:05, 16.01s/it]  6%|▌         | 12/195 [03:46<47:33, 15.59s/it]  7%|▋         | 13/195 [03:59<44:21, 14.62s/it]  7%|▋         | 14/195 [04:10<41:13, 13.67s/it]  8%|▊         | 15/195 [04:21<38:24, 12.80s/it]  8%|▊         | 16/195 [04:31<35:24, 11.87s/it]  9%|▊         | 17/195 [04:40<32:41, 11.02s/it]  9%|▉         | 18/195 [04:49<30:31, 10.35s/it] 10%|▉         | 19/195 [04:55<26:49,  9.14s/it] 10%|█         | 20/195 [05:02<24:46,  8.50s/it] 11%|█         | 21/195 [05:07<21:34,  7.44s/it] 11%|█▏        | 22/195 [05:12<19:40,  6.82s/it] 12%|█▏        | 23/195 [05:29<28:20,  9.89s/it] 12%|█▏        | 24/195 [05:35<24:39,  8.65s/it] 18%|█▊        | 35/195 [05:35<04:03,  1.52s/it] 23%|██▎       | 44/195 [05:35<01:57,  1.28it/s] 26%|██▌       | 51/195 [05:35<01:13,  1.96it/s] 29%|██▉       | 57/195 [05:36<00:51,  2.69it/s] 34%|███▍      | 66/195 [05:36<00:29,  4.34it/s] 59%|█████▉    | 115/195 [05:36<00:04, 17.12it/s] 89%|████████▊ | 173/195 [05:36<00:00, 37.37it/s]100%|██████████| 195/195 [05:36<00:00,  1.73s/it]
done
loading DataFrame
loaded shape: (2524, 5)
Checking and filtering tokens
passed shape: (2524, 5)
Allele length checks
final shape: (1922, 5)
Done
1922/1922 records have matching contig in FASTA
returned 1922/1922 records
Using VcfDataset_SimplePadding (Final Unified Formula) to generate 600bp windows.
  0%|          | 0/193 [00:00<?, ?it/s]/home/mcn26/project_pi_skr2/mcn26/boda2/src/vcf_predict_indel.py:126: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
/home/mcn26/project_pi_skr2/mcn26/boda2/src/vcf_predict_indel.py:89: FutureWarning: We've integrated functorch into PyTorch. As the final step of the integration, `functorch.vmap` is deprecated as of PyTorch 2.0 and will be deleted in a future version of PyTorch >= 2.3. Please use `torch.vmap` instead; see the PyTorch 2.0 release notes and/or the `torch.func` migration guide for more details https://pytorch.org/docs/main/func.migrating.html
  preds = vmap(self.fmodel, in_dims=(0, 0, None))(self.params, self.buffers, batch)
  1%|          | 1/193 [00:00<01:29,  2.14it/s]  2%|▏         | 3/193 [00:00<00:35,  5.30it/s]  3%|▎         | 5/193 [00:00<00:25,  7.26it/s]  4%|▎         | 7/193 [00:01<00:21,  8.51it/s]  5%|▍         | 9/193 [00:01<00:19,  9.34it/s]  6%|▌         | 11/193 [00:01<00:18,  9.90it/s]  7%|▋         | 13/193 [00:01<00:17, 10.28it/s]  8%|▊         | 15/193 [00:01<00:16, 10.53it/s]  9%|▉         | 17/193 [00:01<00:16, 10.59it/s] 10%|▉         | 19/193 [00:02<00:16, 10.76it/s] 11%|█         | 21/193 [00:02<00:15, 10.86it/s] 12%|█▏        | 23/193 [00:02<00:15, 10.95it/s] 13%|█▎        | 25/193 [00:02<00:15, 11.01it/s] 14%|█▍        | 27/193 [00:02<00:15, 11.05it/s] 15%|█▌        | 29/193 [00:02<00:14, 11.08it/s] 16%|█▌        | 31/193 [00:03<00:14, 10.82it/s] 17%|█▋        | 33/193 [00:03<00:15, 10.66it/s] 18%|█▊        | 35/193 [00:03<00:14, 10.80it/s] 19%|█▉        | 37/193 [00:03<00:14, 10.90it/s] 20%|██        | 39/193 [00:03<00:14, 10.97it/s] 21%|██        | 41/193 [00:04<00:13, 11.02it/s] 22%|██▏       | 43/193 [00:04<00:13, 11.05it/s] 23%|██▎       | 45/193 [00:04<00:13, 11.08it/s] 24%|██▍       | 47/193 [00:04<00:13, 11.10it/s] 25%|██▌       | 49/193 [00:04<00:12, 11.10it/s] 26%|██▋       | 51/193 [00:04<00:12, 11.11it/s] 27%|██▋       | 53/193 [00:05<00:12, 11.12it/s] 28%|██▊       | 55/193 [00:05<00:12, 11.12it/s] 30%|██▉       | 57/193 [00:05<00:12, 11.13it/s] 31%|███       | 59/193 [00:05<00:12, 11.12it/s] 32%|███▏      | 61/193 [00:05<00:11, 11.13it/s] 33%|███▎      | 63/193 [00:06<00:11, 10.96it/s] 34%|███▎      | 65/193 [00:06<00:11, 11.01it/s] 35%|███▍      | 67/193 [00:06<00:11, 10.78it/s] 36%|███▌      | 69/193 [00:06<00:11, 10.89it/s] 37%|███▋      | 71/193 [00:06<00:11, 10.97it/s] 38%|███▊      | 73/193 [00:06<00:10, 11.02it/s] 39%|███▉      | 75/193 [00:07<00:10, 11.05it/s] 40%|███▉      | 77/193 [00:07<00:10, 11.07it/s] 41%|████      | 79/193 [00:07<00:10, 11.09it/s] 42%|████▏     | 81/193 [00:07<00:10, 11.11it/s] 43%|████▎     | 83/193 [00:07<00:09, 11.01it/s] 44%|████▍     | 85/193 [00:08<00:09, 11.05it/s] 45%|████▌     | 87/193 [00:08<00:09, 11.08it/s] 46%|████▌     | 89/193 [00:08<00:09, 11.09it/s] 47%|████▋     | 91/193 [00:08<00:09, 11.11it/s] 48%|████▊     | 93/193 [00:08<00:08, 11.12it/s] 49%|████▉     | 95/193 [00:08<00:08, 11.13it/s] 50%|█████     | 97/193 [00:09<00:08, 10.84it/s] 51%|█████▏    | 99/193 [00:09<00:08, 10.93it/s] 52%|█████▏    | 101/193 [00:09<00:08, 10.81it/s] 53%|█████▎    | 103/193 [00:09<00:08, 10.91it/s] 54%|█████▍    | 105/193 [00:09<00:08, 10.98it/s] 55%|█████▌    | 107/193 [00:10<00:07, 11.02it/s] 56%|█████▋    | 109/193 [00:10<00:07, 11.05it/s] 58%|█████▊    | 111/193 [00:10<00:07, 11.08it/s] 59%|█████▊    | 113/193 [00:10<00:07, 11.10it/s] 60%|█████▉    | 115/193 [00:10<00:07, 11.07it/s] 61%|██████    | 117/193 [00:10<00:06, 10.98it/s] 62%|██████▏   | 119/193 [00:11<00:06, 11.03it/s] 63%|██████▎   | 121/193 [00:11<00:06, 11.06it/s] 64%|██████▎   | 123/193 [00:11<00:06, 11.07it/s] 65%|██████▍   | 125/193 [00:11<00:06, 11.10it/s] 66%|██████▌   | 127/193 [00:11<00:05, 11.10it/s] 67%|██████▋   | 129/193 [00:12<00:05, 11.11it/s] 68%|██████▊   | 131/193 [00:12<00:05, 10.95it/s] 69%|██████▉   | 133/193 [00:12<00:05, 11.00it/s] 70%|██████▉   | 135/193 [00:12<00:05, 11.04it/s] 71%|███████   | 137/193 [00:12<00:05, 11.07it/s] 72%|███████▏  | 139/193 [00:12<00:04, 11.09it/s] 73%|███████▎  | 141/193 [00:13<00:04, 11.10it/s] 74%|███████▍  | 143/193 [00:13<00:04, 11.11it/s] 75%|███████▌  | 145/193 [00:13<00:04, 11.12it/s] 76%|███████▌  | 147/193 [00:13<00:04, 11.10it/s] 77%|███████▋  | 149/193 [00:13<00:03, 11.11it/s] 78%|███████▊  | 151/193 [00:14<00:03, 10.88it/s] 79%|███████▉  | 153/193 [00:14<00:03, 10.91it/s] 80%|████████  | 155/193 [00:14<00:03, 10.98it/s] 81%|████████▏ | 157/193 [00:14<00:03, 11.02it/s] 82%|████████▏ | 159/193 [00:14<00:03, 11.05it/s] 83%|████████▎ | 161/193 [00:14<00:02, 11.08it/s] 84%|████████▍ | 163/193 [00:15<00:02, 11.10it/s] 85%|████████▌ | 165/193 [00:15<00:02, 11.11it/s] 87%|████████▋ | 167/193 [00:15<00:02, 10.98it/s] 88%|████████▊ | 169/193 [00:15<00:02, 10.94it/s] 89%|████████▊ | 171/193 [00:15<00:02, 10.89it/s] 90%|████████▉ | 173/193 [00:16<00:01, 10.95it/s] 91%|█████████ | 175/193 [00:16<00:01, 11.00it/s] 92%|█████████▏| 177/193 [00:16<00:01, 11.03it/s] 93%|█████████▎| 179/193 [00:16<00:01, 11.07it/s] 94%|█████████▍| 181/193 [00:16<00:01, 11.09it/s] 95%|█████████▍| 183/193 [00:16<00:00, 11.11it/s] 96%|█████████▌| 185/193 [00:17<00:00, 11.11it/s] 97%|█████████▋| 187/193 [00:17<00:00, 11.12it/s] 98%|█████████▊| 189/193 [00:17<00:00, 11.12it/s] 99%|█████████▉| 191/193 [00:17<00:00, 11.11it/s]100%|██████████| 193/193 [00:17<00:00, 12.36it/s]100%|██████████| 193/193 [00:17<00:00, 10.84it/s]
[+] Finished!
