srun: Job 554807 step creation temporarily disabled, retrying (Requested nodes are busy)
srun: Job 554807 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 554807 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 554807 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 554807 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 554807 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 554807 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 554807 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 554807 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 554807 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 554807 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 554807 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 554807 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 554807 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 554807 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 554807 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 554807 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 554807 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 554807 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 554807 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 554807 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 554807 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 554807 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 554807 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 554807 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 554807 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 554807 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 554807 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 554807 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 554807 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 554807 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 554807 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 554807 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 554807 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 554807 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 554807 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 554807 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 554807 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 554807 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 554807 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 554807 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 554807 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 554807 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 554807 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 554807 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 554807 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 554807 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 554807 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 554807 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 554807 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 554807 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 554807 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 554807 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 554807 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 554807 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 554807 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 554807 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 554807 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 554807 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 554807 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 554807 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 554807 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 554807 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 554807 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 554807 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 554807 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 554807 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 554807 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 554807 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 554807 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 554807 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 554807 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 554807 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 554807 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 554807 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 554807 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 554807 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 554807 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 554807 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 554807 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 554807 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 554807 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 554807 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 554807 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 554807 step creation still disabled, retrying (Requested nodes are busy)
srun: Job 554807 step creation still disabled, retrying (Requested nodes are busy)
srun: Step created for StepId=554807.2
[+] Making ./chr9_chr14/chunk_162 
[*] Running chunk 162 on host: a1122u11n01.mghpcc.ycrc.yale.edu with CUDA_VISIBLE_DEVICES=0
/home/mcn26/.conda/envs/boda_cu128/lib/python3.11/site-packages/lightning/fabric/__init__.py:29: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  __import__("pkg_resources").declare_namespace(__name__)
archive unpacked in ./
archive unpacked in ./
archive unpacked in ./
archive unpacked in ./
archive unpacked in ./
archive unpacked in ./
archive unpacked in ./
archive unpacked in ./
archive unpacked in ./
archive unpacked in ./
/home/mcn26/scratch_pi_skr2/mcn26/sumner_pulldown/boda2/src/vcf_predict.py:102: FutureWarning: We've integrated functorch into PyTorch. As the final step of the integration, `functorch.combine_state_for_ensemble` is deprecated as of PyTorch 2.0 and will be deleted in a future version of PyTorch >= 2.3. Please use `torch.func.stack_module_state` instead; see the PyTorch 2.0 release notes and/or the `torch.func` migration guide for more details https://pytorch.org/docs/main/func.migrating.html
  self.fmodel, self.params, self.buffers = combine_state_for_ensemble(models)
pre-reading fasta into memory
['/home/mcn26/scratch_pi_skr2/mcn26/sumner_pulldown/boda2/src/vcf_predict.py', '--artifact_path', '/home/mcn26/scratch_pi_skr2/mcn26/sumner_pulldown/boda_ensembl_models/chr9_chr14/model_artifacts__20230112_004715__989057.tar.gz', '/home/mcn26/scratch_pi_skr2/mcn26/sumner_pulldown/boda_ensembl_models/chr9_chr14/model_artifacts__20230112_004934__133559.tar.gz', '/home/mcn26/scratch_pi_skr2/mcn26/sumner_pulldown/boda_ensembl_models/chr9_chr14/model_artifacts__20230112_010359__394899.tar.gz', '/home/mcn26/scratch_pi_skr2/mcn26/sumner_pulldown/boda_ensembl_models/chr9_chr14/model_artifacts__20230112_011852__672429.tar.gz', '/home/mcn26/scratch_pi_skr2/mcn26/sumner_pulldown/boda_ensembl_models/chr9_chr14/model_artifacts__20230112_012316__421576.tar.gz', '/home/mcn26/scratch_pi_skr2/mcn26/sumner_pulldown/boda_ensembl_models/chr9_chr14/model_artifacts__20230112_023617__549629.tar.gz', '/home/mcn26/scratch_pi_skr2/mcn26/sumner_pulldown/boda_ensembl_models/chr9_chr14/model_artifacts__20230112_030608__546744.tar.gz', '/home/mcn26/scratch_pi_skr2/mcn26/sumner_pulldown/boda_ensembl_models/chr9_chr14/model_artifacts__20230112_045850__411630.tar.gz', '/home/mcn26/scratch_pi_skr2/mcn26/sumner_pulldown/boda_ensembl_models/chr9_chr14/model_artifacts__20230112_051056__680970.tar.gz', '/home/mcn26/scratch_pi_skr2/mcn26/sumner_pulldown/boda_ensembl_models/chr9_chr14/model_artifacts__20230112_053708__678212.tar.gz', '--use_vmap', 'TRUE', '--vcf_file', '/home/mcn26/scratch_pi_skr2/mcn26/sumner_pulldown/chr9_chr14/GRCh38-dELS-chr9_chr14chunk_162.tsv', '--fasta_file', '/home/mcn26/scratch_pi_skr2/mcn26/GRCh38_no_alt_analysis_set_GCA_000001405.15.fasta', '--output', '/home/mcn26/scratch_pi_skr2/mcn26/output/chr9_chr14/chunk_162.vcf', '--relative_start', '9', '--relative_end', '181', '--step_size', '10', '--raw_predictions', 'FALSE', '--strand_reduction', 'mean', '--window_reduction', 'mean', '--feature_ids', 'K562', 'HepG2', 'SKNSH']
Loaded model from 20230112_004715 in eval mode
Loaded model from 20230112_004934 in eval mode
Loaded model from 20230112_010359 in eval mode
Loaded model from 20230112_011852 in eval mode
Loaded model from 20230112_012316 in eval mode
Loaded model from 20230112_023617 in eval mode
Loaded model from 20230112_030608 in eval mode
Loaded model from 20230112_045850 in eval mode
Loaded model from 20230112_051056 in eval mode
Loaded model from 20230112_053708 in eval mode
  0%|          | 0/44284892 [00:00<?, ?it/s]  1%|▏         | 633208/44284892 [00:00<00:06, 6331633.16it/s]  3%|▎         | 1405607/44284892 [00:00<00:05, 7150446.25it/s]  5%|▍         | 2209100/44284892 [00:00<00:05, 7554138.29it/s]  7%|▋         | 3028183/44284892 [00:00<00:05, 7805367.00it/s]  9%|▊         | 3854875/44284892 [00:00<00:05, 7971687.51it/s] 11%|█         | 4685645/44284892 [00:00<00:04, 8085813.27it/s] 12%|█▏        | 5518939/44284892 [00:00<00:04, 8166515.87it/s] 14%|█▍        | 6356002/44284892 [00:00<00:04, 8231303.14it/s] 16%|█▋        | 7199062/44284892 [00:00<00:04, 8293526.31it/s] 18%|█▊        | 8043828/44284892 [00:01<00:04, 8341037.89it/s] 20%|██        | 8883768/44284892 [00:01<00:04, 8358804.08it/s] 22%|██▏       | 9728329/44284892 [00:01<00:04, 8385134.03it/s] 24%|██▍       | 10575853/44284892 [00:01<00:04, 8412346.98it/s] 26%|██▌       | 11425253/44284892 [00:01<00:03, 8436926.93it/s] 28%|██▊       | 12268946/44284892 [00:01<00:03, 8424863.59it/s] 30%|██▉       | 13111437/44284892 [00:01<00:03, 8402621.52it/s] 32%|███▏      | 13965403/44284892 [00:01<00:03, 8443647.39it/s] 33%|███▎      | 14815522/44284892 [00:01<00:03, 8460837.06it/s] 35%|███▌      | 15661623/44284892 [00:01<00:03, 8435096.38it/s] 37%|███▋      | 16505160/44284892 [00:02<00:03, 8404506.87it/s] 39%|███▉      | 17355379/44284892 [00:02<00:03, 8433615.88it/s] 41%|████      | 18200590/44284892 [00:02<00:03, 8439054.23it/s] 43%|████▎     | 19044525/44284892 [00:02<00:02, 8436007.90it/s] 45%|████▍     | 19892874/44284892 [00:02<00:02, 8450158.61it/s] 47%|████▋     | 20743525/44284892 [00:02<00:02, 8466973.88it/s] 49%|████▉     | 21599930/44284892 [00:02<00:02, 8496014.15it/s] 51%|█████     | 22457768/44284892 [00:02<00:02, 8520644.80it/s] 53%|█████▎    | 23309843/44284892 [00:02<00:02, 8517293.02it/s] 55%|█████▍    | 24168358/44284892 [00:02<00:02, 8537531.10it/s] 57%|█████▋    | 25026830/44284892 [00:03<00:02, 8551598.84it/s] 58%|█████▊    | 25881995/44284892 [00:03<00:02, 8531400.07it/s] 60%|██████    | 26744745/44284892 [00:03<00:02, 8560087.19it/s] 62%|██████▏   | 27600769/44284892 [00:03<00:01, 8553243.63it/s] 64%|██████▍   | 28456105/44284892 [00:03<00:01, 8526529.23it/s] 66%|██████▌   | 29310102/44284892 [00:03<00:01, 8530483.98it/s] 68%|██████▊   | 30171994/44284892 [00:03<00:01, 8556889.93it/s] 70%|███████   | 31027702/44284892 [00:03<00:01, 8532011.26it/s] 72%|███████▏  | 31881964/44284892 [00:03<00:01, 8535082.82it/s] 74%|███████▍  | 32735492/44284892 [00:03<00:01, 8529988.10it/s] 76%|███████▌  | 33596315/44284892 [00:04<00:01, 8553355.65it/s] 78%|███████▊  | 34453938/44284892 [00:04<00:01, 8560149.72it/s] 80%|███████▉  | 35310504/44284892 [00:04<00:01, 8561724.10it/s] 82%|████████▏ | 36166684/44284892 [00:04<00:00, 8506281.79it/s] 84%|████████▎ | 37023991/44284892 [00:04<00:00, 8526153.23it/s] 86%|████████▌ | 37887449/44284892 [00:04<00:00, 8558501.81it/s] 87%|████████▋ | 38747414/44284892 [00:04<00:00, 8570744.74it/s] 89%|████████▉ | 39609329/44284892 [00:04<00:00, 8585169.92it/s] 91%|█████████▏| 40473446/44284892 [00:04<00:00, 8601884.22it/s] 93%|█████████▎| 41333661/44284892 [00:04<00:00, 8569703.85it/s] 95%|█████████▌| 42190675/44284892 [00:05<00:00, 8535612.34it/s] 97%|█████████▋| 43046009/44284892 [00:05<00:00, 8540845.38it/s] 99%|█████████▉| 43907820/44284892 [00:05<00:00, 8563865.53it/s]100%|██████████| 44284892/44284892 [00:05<00:00, 8425453.68it/s]
finding keys
parsing
  0%|          | 0/195 [00:00<?, ?it/s]  1%|          | 1/195 [00:27<1:29:47, 27.77s/it]  1%|          | 2/195 [00:55<1:28:24, 27.48s/it]  2%|▏         | 3/195 [01:17<1:20:34, 25.18s/it]  2%|▏         | 4/195 [01:38<1:15:28, 23.71s/it]  3%|▎         | 5/195 [01:59<1:11:23, 22.55s/it]  3%|▎         | 6/195 [02:18<1:07:30, 21.43s/it]  4%|▎         | 7/195 [02:36<1:03:33, 20.29s/it]  4%|▍         | 8/195 [02:52<59:19, 19.03s/it]    5%|▍         | 9/195 [03:08<55:28, 17.89s/it]  5%|▌         | 10/195 [03:23<52:26, 17.01s/it]  6%|▌         | 11/195 [03:38<50:28, 16.46s/it]  6%|▌         | 12/195 [03:53<48:50, 16.02s/it]  7%|▋         | 13/195 [04:06<45:31, 15.01s/it]  7%|▋         | 14/195 [04:18<42:20, 14.03s/it]  8%|▊         | 15/195 [04:29<39:35, 13.20s/it]  8%|▊         | 16/195 [04:39<36:30, 12.24s/it]  9%|▊         | 17/195 [04:48<33:41, 11.36s/it]  9%|▉         | 18/195 [04:57<31:26, 10.66s/it] 10%|▉         | 19/195 [05:04<27:36,  9.41s/it] 10%|█         | 20/195 [05:11<25:31,  8.75s/it] 11%|█         | 21/195 [05:16<22:14,  7.67s/it] 11%|█▏        | 22/195 [05:22<20:14,  7.02s/it] 12%|█▏        | 23/195 [05:39<29:11, 10.18s/it] 12%|█▏        | 24/195 [05:45<25:24,  8.92s/it] 18%|█▊        | 36/195 [05:45<03:52,  1.46s/it] 23%|██▎       | 45/195 [05:45<01:56,  1.29it/s] 27%|██▋       | 53/195 [05:45<01:09,  2.03it/s] 30%|██▉       | 58/195 [05:46<00:52,  2.62it/s] 37%|███▋      | 72/195 [05:46<00:23,  5.15it/s] 59%|█████▉    | 115/195 [05:46<00:04, 16.02it/s] 89%|████████▊ | 173/195 [05:46<00:00, 35.70it/s]100%|██████████| 195/195 [05:46<00:00,  1.78s/it]
done
loading DataFrame
loaded shape: (498741, 5)
Checking and filtering tokens
passed shape: (498741, 5)
Allele length checks
final shape: (498741, 5)
Done
498741/498741 records have matching contig in FASTA
returned 498741/498741 records
Dataset length: 498741, VCF length: (498741, 5)
  0%|          | 0/49875 [00:00<?, ?it/s]/home/mcn26/scratch_pi_skr2/mcn26/sumner_pulldown/boda2/src/vcf_predict.py:201: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
/home/mcn26/scratch_pi_skr2/mcn26/sumner_pulldown/boda2/src/vcf_predict.py:114: FutureWarning: We've integrated functorch into PyTorch. As the final step of the integration, `functorch.vmap` is deprecated as of PyTorch 2.0 and will be deleted in a future version of PyTorch >= 2.3. Please use `torch.vmap` instead; see the PyTorch 2.0 release notes and/or the `torch.func` migration guide for more details https://pytorch.org/docs/main/func.migrating.html
  preds = vmap(self.fmodel, in_dims=(0, 0, None))(self.params, self.buffers, batch)
  0%|          | 1/49875 [00:00<5:01:32,  2.76it/s]  0%|          | 3/49875 [00:00<2:18:36,  6.00it/s]  0%|          | 5/49875 [00:00<1:48:41,  7.65it/s]  0%|          | 7/49875 [00:00<1:36:38,  8.60it/s]  0%|          | 9/49875 [00:01<1:30:20,  9.20it/s]  0%|          | 11/49875 [00:01<1:26:54,  9.56it/s]  0%|          | 13/49875 [00:01<1:24:40,  9.82it/s]  0%|          | 15/49875 [00:01<1:23:05, 10.00it/s]  0%|          | 17/49875 [00:01<1:22:12, 10.11it/s]  0%|          | 19/49875 [00:02<1:21:37, 10.18it/s]  0%|          | 21/49875 [00:02<1:21:04, 10.25it/s]  0%|          | 23/49875 [00:02<1:20:37, 10.31it/s]  0%|          | 25/49875 [00:02<1:20:32, 10.32it/s]  0%|          | 27/49875 [00:02<1:20:34, 10.31it/s]  0%|          | 29/49875 [00:03<1:20:22, 10.34it/s]  0%|          | 31/49875 [00:03<1:20:13, 10.36it/s]  0%|          | 33/49875 [00:03<1:20:15, 10.35it/s]  0%|          | 35/49875 [00:03<1:20:09, 10.36it/s]  0%|          | 37/49875 [00:03<1:20:10, 10.36it/s]  0%|          | 39/49875 [00:04<1:20:02, 10.38it/s]  0%|          | 41/49875 [00:04<1:20:01, 10.38it/s]  0%|          | 43/49875 [00:04<1:20:06, 10.37it/s]  0%|          | 45/49875 [00:04<1:20:02, 10.37it/s]  0%|          | 47/49875 [00:04<1:20:05, 10.37it/s]  0%|          | 49/49875 [00:04<1:20:22, 10.33it/s]  0%|          | 51/49875 [00:05<1:20:08, 10.36it/s]  0%|          | 53/49875 [00:05<1:20:03, 10.37it/s]  0%|          | 55/49875 [00:05<1:20:08, 10.36it/s]  0%|          | 57/49875 [00:05<1:20:08, 10.36it/s]  0%|          | 59/49875 [00:05<1:20:07, 10.36it/s]  0%|          | 61/49875 [00:06<1:20:14, 10.35it/s]  0%|          | 63/49875 [00:06<1:20:10, 10.36it/s]  0%|          | 65/49875 [00:06<1:20:09, 10.36it/s]  0%|          | 67/49875 [00:06<1:20:12, 10.35it/s]  0%|          | 69/49875 [00:06<1:20:12, 10.35it/s]  0%|          | 71/49875 [00:07<1:20:15, 10.34it/s]  0%|          | 73/49875 [00:07<1:20:16, 10.34it/s]  0%|          | 75/49875 [00:07<1:20:10, 10.35it/s]  0%|          | 77/49875 [00:07<1:20:09, 10.35it/s]  0%|          | 79/49875 [00:07<1:20:20, 10.33it/s]  0%|          | 81/49875 [00:08<1:20:18, 10.33it/s]  0%|          | 83/49875 [00:08<1:20:10, 10.35it/s]  0%|          | 85/49875 [00:08<1:20:11, 10.35it/s]  0%|          | 87/49875 [00:08<1:20:09, 10.35it/s]  0%|          | 89/49875 [00:08<1:20:08, 10.35it/s]  0%|          | 91/49875 [00:09<1:20:11, 10.35it/s]  0%|          | 93/49875 [00:09<1:20:07, 10.35it/s]  0%|          | 95/49875 [00:09<1:20:12, 10.34it/s]  0%|          | 97/49875 [00:09<1:20:06, 10.36it/s]  0%|          | 99/49875 [00:09<1:20:07, 10.35it/s]  0%|          | 101/49875 [00:10<1:20:09, 10.35it/s]  0%|          | 103/49875 [00:10<1:20:04, 10.36it/s]  0%|          | 105/49875 [00:10<1:20:06, 10.36it/s]  0%|          | 107/49875 [00:10<1:20:10, 10.35it/s]slurmstepd: error: *** STEP 554807.2 ON a1122u11n01 CANCELLED AT 2025-07-23T06:01:48 DUE TO TIME LIMIT ***
